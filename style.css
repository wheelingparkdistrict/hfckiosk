// script.js - YouTube Kiosk Player

let player;
let currentPlaylist = [];
let currentVideoIndex = 0;

function onYouTubeIframeAPIReady() {
  player = new YT.Player('player', {
    height: '100%',
    width: '100%',
    videoId: '',
    playerVars: { 'autoplay': 0, 'controls': 1, 'modestbranding': 1 },
    events: {
      'onReady': onPlayerReady,
      'onStateChange': onPlayerStateChange
    }
  });
}

function onPlayerReady(event) {
  // Player is ready
}

function onPlayerStateChange(event) {
  // Handle state changes if needed
}

function loadPlaylist(playlistId) {
  fetch(`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=25&playlistId=${playlistId}&key=AIzaSyBXOnPb8MKxBE1pT6SYvdQdX_87350Nk9g`)
    .then(response => response.json())
    .then(data => {
      currentPlaylist = data.items;
      currentVideoIndex = 0;
      loadVideoByIndex(currentVideoIndex);
      renderPlaylistVideos();
    });
}

function loadVideoByIndex(index) {
  const videoId = currentPlaylist[index].snippet.resourceId.videoId;
  player.loadVideoById(videoId);
}

function renderPlaylistVideos() {
  const playlistVideos = document.getElementById('playlistVideos');
  playlistVideos.innerHTML = '';
  currentPlaylist.forEach((item, index) => {
    const video = document.createElement('div');
    video.classList.add('playlist-video');
    video.innerHTML = `
      <img src="${item.snippet.thumbnails.default.url}" alt="${item.snippet.title}" />
      <span>${item.snippet.title}</span>
    `;
    video.onclick = () => {
      currentVideoIndex = index;
      loadVideoByIndex(currentVideoIndex);
    };
    playlistVideos.appendChild(video);
  });
}

// Playback Controls
document.getElementById('prev').onclick = () => {
  if (currentVideoIndex > 0) {
    currentVideoIndex--;
    loadVideoByIndex(currentVideoIndex);
  }
};

document.getElementById('next').onclick = () => {
  if (currentVideoIndex < currentPlaylist.length - 1) {
    currentVideoIndex++;
    loadVideoByIndex(currentVideoIndex);
  }
};

document.getElementById('playpause').onclick = () => {
  const state = player.getPlayerState();
  if (state === YT.PlayerState.PLAYING) {
    player.pauseVideo();
  } else {
    player.playVideo();
  }
};

// Text resizing
let fontSizeLevel = 2;
const fontSizes = ['14px', '16px', '18px', '20px', '22px'];

function updateFontSize() {
  document.getElementById('playlistPane').style.fontSize = fontSizes[fontSizeLevel];
}

document.getElementById('fontUp').onclick = () => {
  if (fontSizeLevel < fontSizes.length - 1) fontSizeLevel++;
  updateFontSize();
};

document.getElementById('fontDown').onclick = () => {
  if (fontSizeLevel > 0) fontSizeLevel--;
  updateFontSize();
};

// Reload button
document.getElementById('reload').onclick = () => location.reload();
